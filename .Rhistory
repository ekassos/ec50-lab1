knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(estimatr)
library(haven)
library(stargazer)
library(readxl) # you might need to install the readxl package before loading it
library(plot.matrix) # you might need to install the plot.matrix package before loading it
library(sjlabelled) # you might need to install the sjlabelled package before loading it
library(effsize)
select <- dplyr::select
# load the weekly survey files
Jul18 <- read_dta('ns20190718.dta') %>%
remove_all_labels() # we need to remove the labels in order for these files to be joined together
Jul25 <- read_dta('ns20190725.dta')%>%
remove_all_labels()
Aug01 <- read_dta('ns20190801.dta') %>%
remove_all_labels()
Aug08 <- read_dta('ns20190808.dta')%>%
remove_all_labels()
Aug15 <- read_dta('ns20190815.dta')%>%
remove_all_labels()
# join them all together
Summer2019 <- full_join(Jul18,Jul25) %>%
full_join(., Aug01) %>%
full_join(., Aug08) %>%
full_join(., Aug15)
# recode NAs
Summer2019 <- Summer2019 %>%
mutate(across(.cols = everything(), ~na_if(., 999))) %>%
mutate(across(.cols = everything(), ~na_if(., 888)))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(estimatr)
library(haven)
library(stargazer)
library(readxl) # you might need to install the readxl package before loading it
library(plot.matrix) # you might need to install the plot.matrix package before loading it
library(sjlabelled) # you might need to install the sjlabelled package before loading it
library(effsize)
select <- dplyr::select
#Load the data summarizing variable availability
NationscapeVars_1 <- read_xlsx('vars_data.xlsx',sheet = 1) #we're using the read_xlsx function from the readxl package, which lets you specify which sheet to upload if you are using Excel data with multiple sheets
NationscapeVars_2 <- read_xlsx('vars_data.xlsx',sheet = 2)
NationscapeVars <- full_join(NationscapeVars_1,NationscapeVars_2) %>% # the full_join function keeps all rows in both objects and all columns
replace(is.na(.),0) # since we know that the NAs generated in the last command weren't asked in the weeks that show up as NA, we can replace NAs with 0s
heat_data <- NationscapeVars %>% mutate(across(.cols = everything(), as.logical)) %>% select(c(extra_priorities_crime,interest,news_sources_facebook,news_sources_cnn))
plot(t(as.matrix(heat_data)), col = c('red','green'), las = 2) # we're using the plot() function from base R here; it only works this way because we have installed and loaded the plot.matrix package
# create an indicator variable for surveys administered after the mass shootings
Summer2019 <- Summer2019 %>%
mutate(treated = if_else(start_date > as.Date('2019-08-04'), TRUE, FALSE))
difference_in_means(interest ~ treated, data = Summer2019 %>% filter(as.Date('2019-07-31') < start_date) %>% filter(start_date < as.Date('2019-08-09')))
cohen.d(interest ~ treated, data = Summer2019 %>% filter(as.Date('2019-07-31') < start_date) %>% filter(start_date < as.Date('2019-08-09')))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(estimatr)
library(haven)
library(stargazer)
library(effsize)
select <- dplyr::select
#Load the data
covid_data <- read_rds('covid_data_revised.rds')
covid_data %>% mutate(BLM = ifelse(support_BLM > 1, 1, 0))
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 1, 1, 0))
View(covid_data)
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 0, 1, 0))
preds_df %>% ggplot(aes(x = polity)) +
geom_line(aes(y = fit), col = "red") +
geom_line(aes(y = fit + 1.96 * se), col = "gray", lty = "dashed") +
geom_line(aes(y = fit - 1.96 * se), col = "gray", lty = "dashed") +
facet_wrap(~ suffrage) +
labs(x = "Democracy", y = "Number of Conflicts per Year", title = "Number of Conflicts per Year in Non-Suffrage vs. Suffrage Democracies")
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 0, 1, 0))
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 1, 1, 0))
mean(covid_data$education)
mean(covid_data$ideology)
m2 <- lm(BLM ~ covid_burden + gender + education + gender:education, data = covid_data)
stargazer(m2, type = "text")
pred_data1 <- data.frame(covid_burden = seq(1, 7, .01), gender = 0, education = edu_mean)
edu_mean = mean(covid_data$education)
pred_data1 <- data.frame(covid_burden = seq(1, 7, .01), gender = 0, education = edu_mean)
pred_data2 <- data.frame(covid_burden = seq(1, 7, .01), gender = 1, education = edu_mean)
View(pred_data1)
pred_data <- bind_rows(pred_data1, pred_data2)
preds <- predict(m2, pred_data, se.fit = T)
preds_df <- data.frame(fit = preds$fit, se = preds$se.fit, covid_burden = pred_data$covid_burden, gender = pred_data$gender)
preds_df %>% ggplot(aes(x = covid_burden)) +
geom_line(aes(y = fit), col = "red") +
geom_line(aes(y = fit + 1.96 * se), col = "gray", lty = "dashed") +
geom_line(aes(y = fit - 1.96 * se), col = "gray", lty = "dashed") +
facet_wrap(~ gender) +
labs(x = "Democracy", y = "Number of Conflicts per Year", title = "Number of Conflicts per Year in Non-Suffrage vs. Suffrage Democracies")
gender_names <- list(
'0'="Female",
'1'="Male")
gender_names <- c(
'0'="Female",
'1'="Male")
preds_df %>% ggplot(aes(x = covid_burden)) +
geom_line(aes(y = fit), col = "red") +
geom_line(aes(y = fit + 1.96 * se), col = "gray", lty = "dashed") +
geom_line(aes(y = fit - 1.96 * se), col = "gray", lty = "dashed") +
facet_wrap(~ gender, labeller = as_labeller(gender_names)) +
labs(x = "COVID Burden", y = "Number of Conflicts per Year", title = "Number of Conflicts per Year in Males vs. Suffrage Democracies")
preds_df %>% ggplot(aes(x = covid_burden)) +
geom_line(aes(y = fit), col = "red") +
geom_line(aes(y = fit + 1.96 * se), col = "gray", lty = "dashed") +
geom_line(aes(y = fit - 1.96 * se), col = "gray", lty = "dashed") +
facet_wrap(~ gender, labeller = as_labeller(gender_names)) +
labs(x = "COVID Burden", y = "Predicted percentage of respondends who went to the streets to protest\nin support of the Black Lives Matter movement", title = "Number of Conflicts per Year in Males vs. Suffrage Democracies")
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 1, 1, 0))
m2 <- lm(BLM ~ covid_burden + gender + education + gender:education, data = covid_data)
stargazer(m2, type = "text")
edu_mean = mean(covid_data$education)
pred_data1 <- data.frame(covid_burden = seq(1, 7, .01), gender = 0, education = edu_mean)
pred_data2 <- data.frame(covid_burden = seq(1, 7, .01), gender = 1, education = edu_mean)
pred_data <- bind_rows(pred_data1, pred_data2)
preds <- predict(m2, pred_data, se.fit = T)
preds_df <- data.frame(fit = preds$fit, se = preds$se.fit, covid_burden = pred_data$covid_burden, gender = pred_data$gender)
gender_names <- c(
'0'="Female",
'1'="Male")
preds_df %>% ggplot(aes(x = covid_burden)) +
geom_line(aes(y = fit), col = "red") +
geom_line(aes(y = fit + 1.96 * se), col = "gray", lty = "dashed") +
geom_line(aes(y = fit - 1.96 * se), col = "gray", lty = "dashed") +
facet_wrap(~ gender, labeller = as_labeller(gender_names)) +
labs(x = "COVID Burden", y = "Predicted percentage of respondends who went to the streets\nto protest in support of the Black Lives Matter movement", title = "Number of Conflicts per Year in Males vs. Suffrage Democracies")
preds_df %>% ggplot(aes(x = covid_burden)) +
geom_line(aes(y = fit), col = "red") +
geom_line(aes(y = fit + 1.96 * se), col = "gray", lty = "dashed") +
geom_line(aes(y = fit - 1.96 * se), col = "gray", lty = "dashed") +
facet_wrap(~ gender, labeller = as_labeller(gender_names)) +
labs(x = "COVID Burden", y = "Predicted percentage of respondends", title = "Predicted percentage of respondends who went to the streets\nto protest in support of the Black Lives Matter movement in female vs. male respondents")
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 1, 1, 0))
m2 <- lm(BLM ~ covid_burden + gender + education + gender:education, data = covid_data)
stargazer(m2, type = "text")
edu_mean = mean(covid_data$education)
pred_data1 <- data.frame(covid_burden = seq(1, 7, .01), gender = 0, education = edu_mean)
pred_data2 <- data.frame(covid_burden = seq(1, 7, .01), gender = 1, education = edu_mean)
pred_data <- bind_rows(pred_data1, pred_data2)
preds <- predict(m2, pred_data, se.fit = T)
preds_df <- data.frame(fit = preds$fit, se = preds$se.fit, covid_burden = pred_data$covid_burden, gender = pred_data$gender)
gender_names <- c(
'0'="Female",
'1'="Male")
preds_df %>% ggplot(aes(x = covid_burden)) +
geom_line(aes(y = fit), col = "red") +
geom_line(aes(y = fit + 1.96 * se), col = "gray", lty = "dashed") +
geom_line(aes(y = fit - 1.96 * se), col = "gray", lty = "dashed") +
facet_wrap(~ gender, labeller = as_labeller(gender_names)) +
labs(x = "COVID Burden", y = "Predicted percentage of respondends", title = "Predicted percentage of respondends who went to the streets\nto protest in support of the Black Lives Matter movement\nin female vs. male respondents")
preds_df %>% ggplot(aes(x = covid_burden)) +
geom_line(aes(y = fit), col = "red") +
geom_line(aes(y = fit + 1.96 * se), col = "gray", lty = "dashed") +
geom_line(aes(y = fit - 1.96 * se), col = "gray", lty = "dashed") +
facet_wrap(~ gender, labeller = as_labeller(gender_names)) +
labs(x = "COVID Burden", y = "Predicted percentage of respondends", title = "Predicted percentage of respondends who went to the streets\nto protest in support of the Black Lives Matter movement", subtitle = "in female vs. male respondents")
stargazer(m2, type = "text")
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 1, 1, 0))
m2 <- lm(BLM ~ covid_burden + gender + education + gender:education, data = covid_data)
stargazer(m2, type = "text")
edu_mean = mean(covid_data$education)
pred_data1 <- data.frame(covid_burden = seq(1, 7, .01), gender = 0, education = edu_mean)
pred_data2 <- data.frame(covid_burden = seq(1, 7, .01), gender = 1, education = edu_mean)
pred_data <- bind_rows(pred_data1, pred_data2)
preds <- predict(m2, pred_data, se.fit = T)
preds_df <- data.frame(fit = preds$fit, se = preds$se.fit, covid_burden = pred_data$covid_burden, gender = pred_data$gender)
gender_names <- c(
'0'="Female",
'1'="Male")
preds_df %>% ggplot(aes(x = covid_burden)) +
geom_line(aes(y = fit), col = "red") +
geom_line(aes(y = fit + 1.96 * se), col = "gray", lty = "dashed") +
geom_line(aes(y = fit - 1.96 * se), col = "gray", lty = "dashed") +
facet_wrap(~ gender, labeller = as_labeller(gender_names)) +
labs(x = "COVID Burden", y = "Predicted percentage of respondends", title = "Predicted percentage of respondends who went to the streets\nto protest in support of the Black Lives Matter movement", subtitle = "in female vs. male respondents")
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 1, 1, 0))
m2 <- lm(BLM ~ covid_burden + gender + education, data = covid_data)
stargazer(m2, type = "text")
edu_mean = mean(covid_data$education)
pred_data1 <- data.frame(covid_burden = seq(1, 7, .01), gender = 0, education = edu_mean)
pred_data2 <- data.frame(covid_burden = seq(1, 7, .01), gender = 1, education = edu_mean)
pred_data <- bind_rows(pred_data1, pred_data2)
preds <- predict(m2, pred_data, se.fit = T)
preds_df <- data.frame(fit = preds$fit, se = preds$se.fit, covid_burden = pred_data$covid_burden, gender = pred_data$gender)
gender_names <- c(
'0'="Female",
'1'="Male")
preds_df %>% ggplot(aes(x = covid_burden)) +
geom_line(aes(y = fit), col = "red") +
geom_line(aes(y = fit + 1.96 * se), col = "gray", lty = "dashed") +
geom_line(aes(y = fit - 1.96 * se), col = "gray", lty = "dashed") +
facet_wrap(~ gender, labeller = as_labeller(gender_names)) +
labs(x = "COVID Burden", y = "Predicted percentage of respondends", title = "Predicted percentage of respondends who went to the streets\nto protest in support of the Black Lives Matter movement", subtitle = "in female vs. male respondents")
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 1, 1, 0))
m2 <- lm(BLM ~ covid_burden + gender + education + gender:education + race, data = covid_data)
stargazer(m2, type = "text")
edu_mean = mean(covid_data$education)
pred_data1 <- data.frame(covid_burden = seq(1, 7, .01), gender = 0, education = edu_mean)
pred_data2 <- data.frame(covid_burden = seq(1, 7, .01), gender = 1, education = edu_mean)
pred_data <- bind_rows(pred_data1, pred_data2)
preds <- predict(m2, pred_data, se.fit = T)
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 1, 1, 0))
m2 <- lm(BLM ~ covid_burden + gender + education + gender:education + US_ideo, data = covid_data)
stargazer(m2, type = "text")
edu_mean = mean(covid_data$education)
pred_data1 <- data.frame(covid_burden = seq(1, 7, .01), gender = 0, education = edu_mean)
pred_data2 <- data.frame(covid_burden = seq(1, 7, .01), gender = 1, education = edu_mean)
pred_data <- bind_rows(pred_data1, pred_data2)
preds <- predict(m2, pred_data, se.fit = T)
m2 <- lm(BLM ~ covid_burden + gender + education + gender:education + US_ideo, data = covid_data)
stargazer(m2, type = "text")
m2 <- lm(BLM ~ covid_burden + gender + education + gender:education + radical_intention, data = covid_data)
stargazer(m2, type = "text")
m2 <- lm(BLM ~ covid_burden + gender + education + gender:education + radical_intention + spectrum, data = covid_data)
stargazer(m2, type = "text")
m2 <- lm(BLM ~ covid_burden + gender + education + gender:education + radical_intention + spectrum, data = covid_data)
stargazer(m2, type = "text")
m2 <- lm(BLM ~ covid_burden + gender + education + gender:education + radical_intention + spectrum, data = covid_data)
stargazer(m2, type = "text")
s
stargazer(m2, type = "text")
m2 <- lm(BLM ~ covid_burden + gender + radical_intention, data = covid_data)
stargazer(m2, type = "text")
radical_mean = mean(covid_data$radical_intention)
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 1, 1, 0))
m2 <- lm(BLM ~ covid_burden + gender + radical_intention, data = covid_data)
stargazer(m2, type = "text")
radical_mean = mean(covid_data$radical_intention)
pred_data1 <- data.frame(covid_burden = seq(1, 7, .01), gender = 0, radical_intention = radical_mean)
pred_data2 <- data.frame(covid_burden = seq(1, 7, .01), gender = 1, radical_intention = radical_mean)
pred_data <- bind_rows(pred_data1, pred_data2)
preds <- predict(m2, pred_data, se.fit = T)
preds_df <- data.frame(fit = preds$fit, se = preds$se.fit, covid_burden = pred_data$covid_burden, gender = pred_data$gender, radical_intention = radical_mean)
gender_names <- c(
'0'="Female",
'1'="Male")
preds_df %>% ggplot(aes(x = covid_burden)) +
geom_line(aes(y = fit), col = "red") +
geom_line(aes(y = fit + 1.96 * se), col = "gray", lty = "dashed") +
geom_line(aes(y = fit - 1.96 * se), col = "gray", lty = "dashed") +
facet_wrap(~ gender, labeller = as_labeller(gender_names)) +
labs(x = "COVID Burden", y = "Predicted percentage of respondends", title = "Predicted percentage of respondends who went to the streets\nto protest in support of the Black Lives Matter movement", subtitle = "in female vs. male respondents")
preds_df <- data.frame(fit = preds$fit, se = preds$se.fit, covid_burden = pred_data$covid_burden, gender = pred_data$gender, radical_intention = pred_data$radical_mean)
View(preds_df)
preds_df <- data.frame(fit = preds$fit, se = preds$se.fit, covid_burden = pred_data$covid_burden, gender = pred_data$gender)
preds <- predict(m2, pred_data, se.fit = T)
preds_df <- data.frame(fit = preds$fit, se = preds$se.fit, covid_burden = pred_data$covid_burden, gender = pred_data$gender)
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 1, 1, 0))
m2 <- lm(BLM ~ covid_burden + gender + radical_intention, data = covid_data)
stargazer(m2, type = "text")
radical_mean = mean(covid_data$radical_intention)
pred_data1 <- data.frame(covid_burden = seq(1, 7, .01), gender = 0, radical_intention = radical_mean)
pred_data2 <- data.frame(covid_burden = seq(1, 7, .01), gender = 1, radical_intention = radical_mean)
pred_data <- bind_rows(pred_data1, pred_data2)
preds <- predict(m2, pred_data, se.fit = T)
preds_df <- data.frame(fit = preds$fit, se = preds$se.fit, covid_burden = pred_data$covid_burden, gender = pred_data$gender)
gender_names <- c(
'0'="Female",
'1'="Male")
preds_df %>% ggplot(aes(x = covid_burden)) +
geom_line(aes(y = fit), col = "red") +
geom_line(aes(y = fit + 1.96 * se), col = "gray", lty = "dashed") +
geom_line(aes(y = fit - 1.96 * se), col = "gray", lty = "dashed") +
facet_wrap(~ gender, labeller = as_labeller(gender_names)) +
labs(x = "COVID Burden", y = "Predicted percentage of respondends", title = "Predicted percentage of respondends who went to the streets\nto protest in support of the Black Lives Matter movement", subtitle = "in female vs. male respondents")
radical_mean = mean(covid_data$radical_intention)
pred_data1 <- data.frame(covid_burden = seq(1, 7, .01), gender = 0, radical_intention = radical_mean)
View(pred_data1)
radical_mean = mean(covid_data$radical_intention, na.rm = T)
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 1, 1, 0))
m2 <- lm(BLM ~ covid_burden + gender + radical_intention, data = covid_data)
stargazer(m2, type = "text")
radical_mean = mean(covid_data$radical_intention, na.rm = T)
pred_data1 <- data.frame(covid_burden = seq(1, 7, .01), gender = 0, radical_intention = radical_mean)
pred_data2 <- data.frame(covid_burden = seq(1, 7, .01), gender = 1, radical_intention = radical_mean)
pred_data <- bind_rows(pred_data1, pred_data2)
preds <- predict(m2, pred_data, se.fit = T)
preds_df <- data.frame(fit = preds$fit, se = preds$se.fit, covid_burden = pred_data$covid_burden, gender = pred_data$gender)
gender_names <- c(
'0'="Female",
'1'="Male")
preds_df %>% ggplot(aes(x = covid_burden)) +
geom_line(aes(y = fit), col = "red") +
geom_line(aes(y = fit + 1.96 * se), col = "gray", lty = "dashed") +
geom_line(aes(y = fit - 1.96 * se), col = "gray", lty = "dashed") +
facet_wrap(~ gender, labeller = as_labeller(gender_names)) +
labs(x = "COVID Burden", y = "Predicted percentage of respondends", title = "Predicted percentage of respondends who went to the streets\nto protest in support of the Black Lives Matter movement", subtitle = "in female vs. male respondents")
preds_df <- data.frame(fit = preds$fit, se = preds$se.fit, covid_burden = pred_data$covid_burden, gender = pred_data$gender, radical_intention = pred_data$radical_intention)
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 1, 1, 0))
m2 <- lm(BLM ~ covid_burden + gender + radical_intention, data = covid_data)
stargazer(m2, type = "text")
radical_mean = mean(covid_data$radical_intention, na.rm = T)
pred_data1 <- data.frame(covid_burden = seq(1, 7, .01), gender = 0, radical_intention = radical_mean)
pred_data2 <- data.frame(covid_burden = seq(1, 7, .01), gender = 1, radical_intention = radical_mean)
pred_data <- bind_rows(pred_data1, pred_data2)
preds <- predict(m2, pred_data, se.fit = T)
preds_df <- data.frame(fit = preds$fit, se = preds$se.fit, covid_burden = pred_data$covid_burden, gender = pred_data$gender, radical_intention = pred_data$radical_intention)
gender_names <- c(
'0'="Female",
'1'="Male")
preds_df %>% ggplot(aes(x = covid_burden)) +
geom_line(aes(y = fit), col = "red") +
geom_line(aes(y = fit + 1.96 * se), col = "gray", lty = "dashed") +
geom_line(aes(y = fit - 1.96 * se), col = "gray", lty = "dashed") +
facet_wrap(~ gender, labeller = as_labeller(gender_names)) +
labs(x = "COVID Burden", y = "Predicted percentage of respondends", title = "Predicted percentage of respondends who went to the streets\nto protest in support of the Black Lives Matter movement", subtitle = "in female vs. male respondents")
m2 <- lm(BLM ~ covid_burden + gender:radical_intention, data = covid_data)
stargazer(m2, type = "text")
m2 <- lm(BLM ~ covid_burden + gender+radical_intention+ gender:radical_intention, data = covid_data)
stargazer(m2, type = "text")
radical_mean = mean(covid_data$radical_intention, na.rm = T)
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 1, 1, 0))
m2 <- lm(BLM ~ covid_burden + gender+radical_intention+ gender:radical_intention, data = covid_data)
stargazer(m2, type = "text")
radical_mean = mean(covid_data$radical_intention, na.rm = T)
pred_data1 <- data.frame(covid_burden = seq(1, 7, .01), gender = 0, radical_intention = radical_mean)
pred_data2 <- data.frame(covid_burden = seq(1, 7, .01), gender = 1, radical_intention = radical_mean)
pred_data <- bind_rows(pred_data1, pred_data2)
preds <- predict(m2, pred_data, se.fit = T)
preds_df <- data.frame(fit = preds$fit, se = preds$se.fit, covid_burden = pred_data$covid_burden, gender = pred_data$gender, radical_intention = pred_data$radical_intention)
gender_names <- c(
'0'="Female",
'1'="Male")
preds_df %>% ggplot(aes(x = covid_burden)) +
geom_line(aes(y = fit), col = "red") +
geom_line(aes(y = fit + 1.96 * se), col = "gray", lty = "dashed") +
geom_line(aes(y = fit - 1.96 * se), col = "gray", lty = "dashed") +
facet_wrap(~ gender, labeller = as_labeller(gender_names)) +
labs(x = "COVID Burden", y = "Predicted percentage of respondends", title = "Predicted percentage of respondends who went to the streets\nto protest in support of the Black Lives Matter movement", subtitle = "in female vs. male respondents")
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 1, 1, 0))
m2 <- lm(BLM ~ covid_burden + gender + radical_intention, data = covid_data)
stargazer(m2, type = "text")
radical_mean = mean(covid_data$radical_intention, na.rm = T)
pred_data1 <- data.frame(covid_burden = seq(1, 7, .01), gender = 0, radical_intention = radical_mean)
pred_data2 <- data.frame(covid_burden = seq(1, 7, .01), gender = 1, radical_intention = radical_mean)
pred_data <- bind_rows(pred_data1, pred_data2)
preds <- predict(m2, pred_data, se.fit = T)
preds_df <- data.frame(fit = preds$fit, se = preds$se.fit, covid_burden = pred_data$covid_burden, gender = pred_data$gender, radical_intention = pred_data$radical_intention)
gender_names <- c(
'0'="Female",
'1'="Male")
preds_df %>% ggplot(aes(x = covid_burden)) +
geom_line(aes(y = fit), col = "red") +
geom_line(aes(y = fit + 1.96 * se), col = "gray", lty = "dashed") +
geom_line(aes(y = fit - 1.96 * se), col = "gray", lty = "dashed") +
facet_wrap(~ gender, labeller = as_labeller(gender_names)) +
labs(x = "COVID Burden", y = "Predicted percentage of respondends", title = "Predicted percentage of respondends who went to the streets\nto protest in support of the Black Lives Matter movement", subtitle = "in female vs. male respondents")
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 1, 1, 0))
m2 <- lm(BLM ~ covid_burden + gender_names + radical_intention, data = covid_data)
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 1, 1, 0))
m2 <- lm(BLM ~ covid_burden + gender_names + radical_intention, data = covid_data)
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 1, 1, 0))
m2 <- lm(BLM ~ covid_burden + gender_names + radical_intention, data = covid_data)
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 1, 1, 0))
m2 <- lm(BLM ~ covid_burden + gender + radical_intention, data = covid_data)
stargazer(m2, type = "text")
radical_mean = mean(covid_data$radical_intention, na.rm = T)
pred_data1 <- data.frame(covid_burden = seq(1, 7, .01), gender = 0, radical_intention = radical_mean)
pred_data2 <- data.frame(covid_burden = seq(1, 7, .01), gender = 1, radical_intention = radical_mean)
pred_data <- bind_rows(pred_data1, pred_data2)
preds <- predict(m2, pred_data, se.fit = T)
preds_df <- data.frame(fit = preds$fit, se = preds$se.fit, covid_burden = pred_data$covid_burden, gender = pred_data$gender, radical_intention = pred_data$radical_intention)
gender_names <- c(
'0'="Female",
'1'="Male")
preds_df %>% ggplot(aes(x = covid_burden)) +
geom_line(aes(y = fit), col = "red") +
geom_line(aes(y = fit + 1.96 * se), col = "gray", lty = "dashed") +
geom_line(aes(y = fit - 1.96 * se), col = "gray", lty = "dashed") +
facet_wrap(~ gender, labeller = as_labeller(gender_names)) +
labs(x = "COVID Burden", y = "Predicted percentage of respondends", title = "Predicted percentage of respondends who went to the streets\nto protest in support of the Black Lives Matter movement", subtitle = "in female vs. male respondents")
covid_data <- covid_data %>% mutate(BLM = ifelse(support_BLM > 1, 1, 0))
m2 <- lm(BLM ~ covid_burden + gender + radical_intention, data = covid_data)
stargazer(m2, type = "text")
radical_mean = mean(covid_data$radical_intention, na.rm = T)
pred_data1 <- data.frame(covid_burden = seq(1, 7, .01), gender = 0, radical_intention = radical_mean)
pred_data2 <- data.frame(covid_burden = seq(1, 7, .01), gender = 1, radical_intention = radical_mean)
pred_data <- bind_rows(pred_data1, pred_data2)
preds <- predict(m2, pred_data, se.fit = T)
preds_df <- data.frame(fit = preds$fit, se = preds$se.fit, covid_burden = pred_data$covid_burden, gender = pred_data$gender, radical_intention = pred_data$radical_intention)
gender_names <- c(
'1'="Female",
'0'="Male")
preds_df %>% ggplot(aes(x = covid_burden)) +
geom_line(aes(y = fit), col = "red") +
geom_line(aes(y = fit + 1.96 * se), col = "gray", lty = "dashed") +
geom_line(aes(y = fit - 1.96 * se), col = "gray", lty = "dashed") +
facet_wrap(~ gender, labeller = as_labeller(gender_names)) +
labs(x = "COVID Burden", y = "Predicted percentage of respondends", title = "Predicted percentage of respondends who went to the streets\nto protest in support of the Black Lives Matter movement", subtitle = "in female vs. male respondents")
setwd("~/Documents/EC50/Lab 1")
rm(list=ls()) # removes all objects from the environment
cat('\014') # clears the console
if (!require(tidyverse)) install.packages("tidyverse"); library(tidyverse)
if (!require(haven)) install.packages("haven"); library(haven)
if (!require(ggplot2)) install.packages("ggplot2"); library(ggplot2)
if (!require(statar)) install.packages("statar"); library(statar)
if (!require(Rstata)) install.packages("Rstata"); library(Rstata)
if (!require(RStata)) install.packages("RStata"); library(RStata)
nlsy <- read_dta("nlsy97.dta")
if (!require(RStata)) install.packages("RStata"); library(RStata)
histogram yvar
graph export histogram_yvar.png, replace
describe
hist(nlsy$yvar, probability = T)
hist(nlsy$yvar, probability = T)
View(nlsy)
hist(nlsy$kid_income, probability = T)
ggplot(nlsy) + geom_histogram(aes(x=kid_income, y=..density..)) ggsave("histogram_kid_income.png")
ggplot(nlsy) + geom_histogram(aes(x=kid_income, y=..density..))
ggsave("histogram_kid_income.png")
ggplot(nlsy) + geom_histogram(aes(x=kid_income, y=..density..), bins = 50)
ggsave("histogram_kid_income.png")
mean(nlsy$kid_income, na.rm=TRUE)
gen below_mean = 0
replace below_mean = 1 if kid_income < mean(nlsy$kid_income, na.rm=TRUE)
nlsy$below_mean <- 0
nlsy$below_mean <- ifelse(nlsy$kid_income < mean(nlsy$kid_income, na.rm=TRUE), 1, 0)
n_observ = nrow(nlsy)
pct = sum(nlsy$below_mean)
pct = sum(nlsy$below_mean)/nrow(nlsy)
median((nlsy$kid_income, na.rm=TRUE)
median(nlsy$kid_income, na.rm=TRUE)
sum(nlsy$below_mean)/nrow(nlsy)
sd(nlsy$kid_income, na.rm=TRUE)
kid_income_sd = sd(nlsy$kid_income, na.rm=TRUE)
kid_income_mean = mean(nlsy$kid_income, na.rm=TRUE)
sum(nlsy$kid_income < kid_income_mean + kid_income_sd & nlsy$kid_income > kid_income_mean - kid_income_sd, ma.rm = TRUE)
fractionOneDeviation = sum(nlsy$kid_income < kid_income_mean + kid_income_sd & nlsy$kid_income > kid_income_mean - kid_income_sd, ma.rm = TRUE)
fractionTwoDeviations = sum(nlsy$kid_income < kid_income_mean + 2 * kid_income_sd & nlsy$kid_income > kid_income_mean - 2 * kid_income_sd, ma.rm = TRUE)
nObservations = nrow(nlsy)
fractionOneDeviation = sum(nlsy$kid_income < kid_income_mean + kid_income_sd & nlsy$kid_income > kid_income_mean - kid_income_sd, ma.rm = TRUE) / nObservations
fractionTwoDeviations = sum(nlsy$kid_income < kid_income_mean + 2 * kid_income_sd & nlsy$kid_income > kid_income_mean - 2 * kid_income_sd, ma.rm = TRUE) / nObservations
fractionOneDeviation
fractionTwoDeviations
percentile_rank <- function(x){
rank <- ifesle(is.na(x), NA, rank(x, ties.method = "average"))
100*rank/max(r, na.rm=T)
}
nlsy$kid_inc_rank <- percentile_rank(nlsy$kid_income)
nlsy$kid_inc_rank <- percentile_rank(nlsy$kid_income)
percentile_rank <- function(x){
rank <- ifelse(is.na(x), NA, rank(x, ties.method = "average"))
100*rank/max(r, na.rm=T)
}
nlsy$kid_inc_rank <- percentile_rank(nlsy$kid_income)
percentile_rank <- function(x){
rank <- ifelse(is.na(x), NA, rank(x, ties.method = "average"))
100*rank/max(rank, na.rm=T)
}
nlsy$kid_inc_rank <- percentile_rank(nlsy$kid_income)
ggplot(nlsy) + geom_histogram(aes(x=kid_inc_rank, y=..density..), bins = 50)
ggsave("histogram_kid_inc_rank.png")
kid_inc_rank_mean = mean(nlsy$kid_inc_rank, na.rm=TRUE)
kid_inc_rank_median = median(nlsy$kid_inc_rank, na.rm=TRUE)
install.packages("statar")
install.packages("statar")
library(statar)
ggplot(nlsy, aes(x = kid_income , y = child_education)) +
stat_binmean(n = 20, geom = "line") +
stat_binmean(n = 20, geom = "point")
ggplot(nlsy, aes(x = kid_income , y = child_sat)) +
stat_binmean(n = 20, geom = "line") +
stat_binmean(n = 20, geom = "point")
ggplot(nlsy, aes(x = kid_income , y = parent_inc)) +
stat_binmean(n = 20, geom = "line") +
stat_binmean(n = 20, geom = "point")
ggplot(nlsy, aes(x = kid_income , y = cohort)) +
stat_binmean(n = 20, geom = "line") +
stat_binmean(n = 20, geom = "point")
set.seed(21423503)
nlsy$random_number <- runif(length(nlsy$kid_income))
nlsy$treatment_group <- ifelse(nlsy$random_number < 0.5), 0, 1)
nlsy$treatment_group <- ifelse(nlsy$random_number < 0.5, 0, 1)
ggplot(nlsy, aes(x = kid_income , y = cohort)) +
stat_binmean(n = 20, geom = "point")
sum(nlsy$treatment_group == 0)
sum(nlsy$treatment_group == 1)
nControl = sum(nlsy$treatment_group == 0)
nTreatment = sum(nlsy$treatment_group == 1)
options(dplyr.width = Inf)
nlsy %>% group_by(treatment_group) %>% summarise_all("mean")
nlsy %>% group_by(treatment_group) %>% summarise_all("sd")
by(nlsy$parent_inc, list(nlsy$treatment_group), mean)
by(nlsy$parent_inc, list(nlsy$treatment_group), sd)
ggplot(nlsy, aes(x = kid_income , y = child_education)) +
stat_binmean(n = 20, geom = "line") +
stat_binmean(n = 20, geom = "point")
ggplot(nlsy, aes(x = child_education , y = kid_income)) +
stat_binmean(n = 20, geom = "line") +
stat_binmean(n = 20, geom = "point")
ggplot(nlsy, aes(x = child_sat , y = kid_income)) +
stat_binmean(n = 20, geom = "line") +
stat_binmean(n = 20, geom = "point")
ggplot(nlsy, aes(x = parent_inc , y = kid_income)) +
stat_binmean(n = 20, geom = "line") +
stat_binmean(n = 20, geom = "point")
ggplot(nlsy, aes(x =  cohort, y = kid_income)) +
stat_binmean(n = 20, geom = "line") +
stat_binmean(n = 20, geom = "point")
ggplot(nlsy, aes(x =  age2015, y = kid_income)) +
stat_binmean(n = 20, geom = "line") +
stat_binmean(n = 20, geom = "point")
remotes::install_github("anthonynorth/rscodeio")
install_github("anthonynorth/rscodeio")
install.packages('remotes')
remotes::install_github("anthonynorth/rscodeio")
rscodeio::install_theme()
remotes::install_github("rileytwo/darkstudio")
darkstudio::activate()
darkstudio::activate()
